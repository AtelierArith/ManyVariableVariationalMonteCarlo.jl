# ManyVariableVariationalMonteCarlo.jl - 不足している機能のTODOリスト

このドキュメントは、C参照実装（mVMC）と比較してJulia実装で不足している主要な機能をリストアップしています。

## 🏗️ コア機能の不足

### 1. StdFace標準格子モデルジェネレータ
**優先度: 高**
- [ ] 正方格子 (SquareLattice.c)
- [ ] ハニカム格子 (HoneycombLattice.c)
- [ ] 三角格子 (TriangularLattice.c)
- [ ] カゴメ格子 (Kagome.c)
- [ ] はしご格子 (Ladder.c)
- [ ] 一次元鎖 (ChainLattice.c)
- [ ] パイロクロア格子 (Pyrochlore.c)
- [ ] 斜方晶格子 (Orthorhombic.c)

**現状**: 基本的な設定ファイル解析のみ実装済み。格子構造の自動生成機能が未実装。

### 2. メインVMCシミュレーションワークフロー
**優先度: 最高**
- [ ] vmcmain.c相当のメイン実行ループ
- [ ] パラメータ最適化モード (VMCParaOpt)
- [ ] 物理量計算モード (VMCPhysCal)
- [ ] 計算モード切り替え (NVMCCalMode)
- [ ] マルチ定義ファイルサポート

**現状**: 基本的なサンプリング例のみ。完全なワークフローが未実装。

### 3. ハミルトニアン計算エンジン
**優先度: 最高**
- [ ] 標準ハミルトニアン計算 (calham.c)
- [ ] 実数版ハミルトニアン (calham_real.c)
- [ ] 固定スピン版 (calham_fsz.c, calham_fsz_real.c)
- [ ] エネルギー期待値計算
- [ ] 力の計算（変分微分）

**現状**: 基本的なエネルギー計算の枠組みのみ。

## 🧮 数値計算機能

### 4. Lanczos法統合
**優先度: 高**
- [ ] 単一Lanczosステップ (physcal_lanczos.c)
- [ ] グリーン関数測定との統合
- [ ] 励起状態計算
- [ ] スペクトル関数計算

**現状**: 未実装。

### 5. 高度な量子射影演算子
**優先度: 中**
- [ ] OptTrans最適化変換
- [ ] 並進対称性射影
- [ ] 点群対称性射影
- [ ] 時間反転対称性
- [ ] 粒子・正孔対称性

**現状**: 基本的なスピン射影のみ実装。

### 6. 固定スピン（FSZ）モード
**優先度: 中**
- [ ] 固定スピン配置でのサンプリング
- [ ] FSZ専用アップデート
- [ ] FSZ用グリーン関数
- [ ] FSZ用スレーター行列式

**現状**: 未実装。

## 🌊 波動関数コンポーネント

### 7. バックフロー補正
**優先度: 中**
- [ ] バックフロー軌道補正
- [ ] etaパラメータ管理
- [ ] バックフロー項を含むスレーター行列式
- [ ] バックフロー勾配計算

**現状**: 未実装。

### 8. 多軌道模型サポート
**優先度: 中**
- [ ] 軌道インデックス管理
- [ ] 多軌道ハバード模型
- [ ] 軌道間相互作用
- [ ] 軌道対称性

**現状**: 単軌道系のみサポート。

## 🎯 物理観測量

### 9. 包括的物理観測量計算
**優先度: 高**
- [ ] スピン相関関数
- [ ] 密度相関関数
- [ ] 超伝導相関関数
- [ ] 運動量分布
- [ ] 構造因子
- [ ] カスタム観測量フレームワーク

**現状**: 基本的なエネルギー測定のみ。

### 10. 高次グリーン関数
**優先度: 中**
- [ ] 4体グリーン関数
- [ ] 動的グリーン関数
- [ ] 非対角グリーン関数
- [ ] 大規模系グリーン関数

**現状**: 基本的な1体・2体グリーン関数の枠組みのみ。

## 🔄 モンテカルロ更新

### 11. 高度なMC更新手法
**優先度: 高**
- [ ] 交換ホッピング更新 (NExUpdatePath)
- [ ] ブロックパフィアン更新
- [ ] クラスター更新
- [ ] 対生成・消滅更新

**現状**: 基本的な単電子・双電子更新のみ。

### 12. 反周期境界条件
**優先度: 低**
- [ ] 反周期境界条件サポート (APFlag)
- [ ] 境界条件に応じた位相因子
- [ ] トポロジカル効果

**現状**: 周期境界条件のみ。

## 💾 I/O・データ管理

### 13. mVMC互換出力システム
**優先度: 高**
- [ ] zvo_*.dat形式出力
- [ ] zqp_*.dat形式出力
- [ ] バイナリ出力サポート
- [ ] チェックポイント・リスタート機能

**現状**: 基本的なテキスト出力のみ。

### 14. Wannier90インターフェース
**優先度: 中**
- [ ] Wannier90データ読み込み
- [ ] 現実物質計算サポート
- [ ] 軌道情報統合

**現状**: 未実装。

### 15. UHF計算統合
**優先度: 中**
- [ ] ComplexUHF統合
- [ ] 初期波動関数生成
- [ ] UHF結果からのVMC開始

**現状**: 未実装。

## ⚡ 高性能計算

### 16. MPI並列化
**優先度: 中**
- [ ] MPI分散計算
- [ ] 大規模並列サンプリング
- [ ] 通信最適化
- [ ] 負荷分散

**現状**: スレッド並列のみ。

### 17. 共役勾配ソルバー統合
**優先度: 中**
- [ ] SR方程式のCG解法
- [ ] 前処理付きCG
- [ ] 収束判定
- [ ] 安定化手法

**現状**: 基本的なLAPACK解法のみ。

### 18. 包括的プロファイリング
**優先度: 低**
- [ ] 詳細タイマーシステム
- [ ] メモリ使用量監視
- [ ] 性能解析レポート
- [ ] ボトルネック特定

**現状**: 基本的なベンチマーク機能のみ。

## 🎛️ 設定・制御

### 19. 相関因子シフトフラグ
**優先度: 低**
- [ ] Gutzwiller-Jastrowシフト (FlagShiftGJ)
- [ ] Doublon-Holonシフト (FlagShiftDH2, FlagShiftDH4)
- [ ] シフト最適化

**現状**: 未実装。

### 20. ファイルフラッシュ制御
**優先度: 低**
- [ ] 出力ファイル自動フラッシュ
- [ ] フラッシュ間隔制御
- [ ] 大規模計算での安全性

**現状**: 未実装。

---

## 📊 実装優先度マトリックス

| 機能カテゴリ | 優先度 | 実装難易度 | 影響度 |
|-------------|--------|-----------|--------|
| メインワークフロー | 最高 | 高 | 最高 |
| ハミルトニアン計算 | 最高 | 高 | 最高 |
| StdFace格子 | 高 | 中 | 高 |
| 物理観測量 | 高 | 中 | 高 |
| MC更新手法 | 高 | 中 | 中 |
| 出力システム | 高 | 低 | 中 |
| Lanczos統合 | 高 | 高 | 中 |
| 量子射影 | 中 | 高 | 中 |
| バックフロー | 中 | 高 | 低 |
| 多軌道サポート | 中 | 中 | 中 |
| MPI並列化 | 中 | 高 | 中 |

## 🚀 推奨実装順序

1. **Phase 1 (基盤)**:メインワークフロー → ハミルトニアン計算 → StdFace格子
2. **Phase 2 (コア機能)**: 物理観測量 → MC更新手法 → 出力システム
3. **Phase 3 (高度機能)**: Lanczos統合 → 量子射影 → 並列化

この順序で実装することで、段階的に機能を拡張し、各段階で動作確認が可能になります。
